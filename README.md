# project_ITMO

## Описание приложения

Данное консольное приложение предназначено для управления театральными спектаклями и регистрацией зрителей. Оно позволяет администраторам добавлять, удалять и просматривать спектакли, а также управлять информацией о покупателях. Пользователи могут просматривать доступные спектакли и регистрироваться на них, а также отменять свои заказы. Приложение использует язык программирования Python и библиотеку SQLite3 для работы с базой данных.

## Аналитика: Выбор Python и библиотеки SQLite3

### Язык программирования: Python

Python был выбран в качестве основного языка программирования для разработки данного приложения по следующим причинам:

1. Простота и удобство  
   Python — это язык высокого уровня, который предоставляет понятный и лаконичный синтаксис, что позволяет разработчику сосредоточиться на логике приложения, а не на сложностях синтаксиса. Приложения на Python легко читать, поддерживать и расширять, что особенно важно для систем, где требуется частое добавление функциональности.

2. Поддержка встроенных библиотек  
   Python обладает широким спектром встроенных библиотек, включая sqlite3, что упрощает работу с базами данных. Встроенные библиотеки также способствуют уменьшению внешних зависимостей и обеспечивают стабильность приложения.

3. Переносимость и кросс-платформенность  
   Python является кросс-платформенным, что означает, что приложение может быть запущено на различных операционных системах без необходимости изменения кода. Это важно для консольного приложения, которое должно легко устанавливаться и использоваться в разных окружениях.

4. Сообщество и поддержка  
   Python имеет одно из самых больших и активных сообществ разработчиков, что обеспечивает доступность подробной документации и технической поддержки, а также стабильные обновления языка и его библиотек. Это делает Python удобным выбором для долгосрочных проектов.

5. Широкие возможности для автоматизации и работы с базами данных  
   Python предоставляет удобные и мощные инструменты для работы с файлами и базами данных, что делает его подходящим для создания консольных приложений, взаимодействующих с базой данных.

### Библиотека SQLite3

SQLite3 была выбрана как основная база данных по следующим причинам:

1. Легкость интеграции и отсутствие необходимости в установке сервера  
   SQLite — это встроенная SQL-база данных, которая не требует настройки и установки отдельного серверного ПО. Данные хранятся в одном файле (theater.db), что упрощает переносимость и делает её удобной для небольших проектов или приложений с одной базой данных, таких как это приложение для управления театральными спектаклями и регистрацией зрителей.

2. Простота использования и поддержка SQL  
   SQLite поддерживает стандарты SQL, что обеспечивает совместимость с другими SQL-системами и делает переход к другим СУБД (например, PostgreSQL или MySQL) менее трудоемким при необходимости. SQL-запросы позволяют выполнять сложные операции с данными, например, ранжирование событий по продажам билетов.

3. Высокая производительность для небольших и средних объемов данных  
   SQLite отлично справляется с операциями для небольших и средних объемов данных, что подходит для задачи учета спектаклей и зарегистрированных пользователей. Она эффективна для операций чтения и записи, не требует сложной конфигурации и может работать быстро даже на ограниченных ресурсах.

4. Поддержка транзакций и обеспечения целостности данных  
   SQLite поддерживает транзакции и гарантирует сохранение целостности данных, что важно для функций, связанных с изменением количества свободных мест и отменой заказов.

5. Совместимость с Python  
   Библиотека sqlite3, встроенная в Python, позволяет легко выполнять SQL-запросы и управлять соединениями к базе данных, обеспечивая удобный и понятный интерфейс для работы с данными.
Таким образом, использование Python и SQLite3 для данного приложения оправдано следующими критериями: простота реализации и поддержки, минимальные требования к инфраструктуре, а также высокая производительность для задач с небольшим объемом данных.

# Документация к базе данных theater.db
*Создание базы данных 'theater.db' реализуется в файле  creating_theater.db.py*

## Описание базы данных

База данных theater.db используется в приложении для управления театральными спектаклями и регистрацией зрителей. Она содержит три таблицы, каждая из которых выполняет определенные функции для хранения и управления данными.

## Структура базы данных

### 1. Таблица events

Таблица events содержит информацию о спектаклях, доступных для покупки билетов.

| Поле           | Тип       | Описание                                           |
|----------------|-----------|----------------------------------------------------|
| id           | INTEGER   | Уникальный идентификатор спектакля (PRIMARY KEY)  |
| name         | TEXT      | Название спектакля                                 |
| price        | INTEGER   | Цена билета на спектакль                          |
| date         | TEXT      | Дата проведения спектакля                          |
| free_slots   | INTEGER   | Количество свободных мест на спектакле             |

### 2. Таблица customers

Таблица customers содержит информацию о покупателях, зарегистрированных в приложении.

| Поле           | Тип       | Описание                                           |
|----------------|-----------|----------------------------------------------------|
| id           | INTEGER   | Уникальный идентификатор покупателя (PRIMARY KEY) |
| name         | TEXT      | Имя покупателя                                     |
| age          | INTEGER   | Возраст покупателя                                 |
| email        | TEXT      | Электронная почта (UNIQUE)                        |
| phone        | TEXT      | Номер телефона                                     |

### 3. Таблица orders

Таблица orders содержит информацию о заказах, сделанных покупателями на спектакли.

| Поле           | Тип       | Описание                                           |
|----------------|-----------|----------------------------------------------------|
| order_id     | INTEGER   | Уникальный идентификатор заказа (PRIMARY KEY)     |
| event_id     | INTEGER   | Идентификатор спектакля (FOREIGN KEY)             |
| customer_id  | INTEGER   | Идентификатор покупателя (FOREIGN KEY)            |
| event_name   | TEXT      | Название спектакля                                  |
| event_price  | INTEGER   | Цена билета на спектакль                           |

## Взаимосвязи между таблицами

- Таблица orders содержит внешние ключи event_id и customer_id, которые ссылаются на id в таблицах events и customers соответственно. Это позволяет связать информацию о заказах с соответствующими спектаклями и покупателями.                
# Введение
Данный отчет предназначен для описания функционала приложения, связанного с работой с покупателями и администраторами.
Отчет включает детали о связанных файлах, основных функциях и взаимосвязи между ними, а также функциональных возможностях для удобства пользователей.
# Документация к функционалу работы с покупателями

## Связанные файлы

В данной части приложения для работы с покупателями используются следующие файлы:

1. **`customer_main.py`** — основной файл, который управляет взаимодействием пользователя с приложением, предоставляет меню и обрабатывает пользовательские команды.
  
2. **`customer_modules.py`** — файл, содержащий функции, связанные с управлением покупателями и регистрацией на спектакли. Эти функции выполняют основные операции, такие как просмотр спектаклей и регистрация покупателей.

## Функционал

### Основные функции, относящиеся к покупателям

1. **`view_events()`**

   - **Описание**: Эта функция отображает список доступных спектаклей, которые можно приобрести. 
   - **Функционал**: 
     - Подключается к базе данных.
     - Выполняет SQL-запрос для выборки спектаклей, у которых есть свободные места.
     - Если спектакли найдены, отображает их с деталями (ID, название, цена, дата, свободные места).
     - Позволяет пользователю выбрать спектакль по его ID для дальнейшей регистрации.
     - Если спектаклей нет, информирует пользователя и возвращает его в главное меню.

2. **`register_customer(event_id, event_name, event_price)`**

   - **Описание**: Эта функция отвечает за регистрацию покупателя и создание заказа на выбранный спектакль.
   - **Функционал**: 
     - Подключается к базе данных.
     - Сбор информации от пользователя: имя, возраст, электронная почта и телефон.
     - Вставка информации о покупателе в таблицу `customers`. Если покупатель уже существует (по уникальному полю email), то запись не создаётся, благодаря использованию `INSERT OR IGNORE`.
     - Получение ID покупателя из таблицы `customers`.
     - Создание записи в таблице `orders`, связывая покупателя с выбранным спектаклем.
     - Уменьшение количества доступных мест в спектакле на единицу.
     - Обработка ошибок и вывод сообщений о результате операции.

3. **`cancel_ticket()`**

   - **Описание**: Эта функция позволяет пользователю отменить ранее купленный билет.
   - **Функционал**:
     - Подключается к базе данных.
     - Запрашивает у пользователя номер заказа, который он хочет отменить.
     - Проверяет наличие заказа в таблице `orders` по введённому ID.
     - Если заказ найден, удаляет запись из таблицы `orders` и увеличивает количество свободных мест в соответствующем спектакле.
     - Обрабатывает ошибки, например, если заказ не найден, и возвращает пользователя в главное меню.

## Взаимосвязь функций

- **`view_events()`** инициирует процесс регистрации, передавая необходимые параметры в **`register_customer()`**, если пользователь выбрал спектакль.
- **`register_customer()`** управляет добавлением данных о покупателе и созданием заказа, обрабатывая возможные конфликты при регистрации (например, если покупатель уже зарегистрирован).
- **`cancel_ticket()`** обеспечивает возможность пользователям управлять своими заказами, что важно для удобства работы с приложением.

# Документация к функционалу работы с администратором

## Связанные файлы

В данной части приложения для работы с администратором используются следующие файлы:

1. **`admin_main.py`** — основной файл, который управляет взаимодействием администратора с приложением, предоставляет меню и обрабатывает команды.
  
2. **`admin_modules.py`** — файл, содержащий функции, связанные с управлением спектаклями, покупателями и отчетами. Эти функции выполняют основные операции, такие как добавление и удаление спектаклей, а также получение информации о покупателях и спектаклях.

## Функционал

### Основные функции, относящиеся к администратору

1. **`view_events()`**

   - **Описание**: Эта функция отображает список актуальных спектаклей в базе данных.
   - **Функционал**: 
     - Подключается к базе данных.
     - Выполняет SQL-запрос для выборки всех спектаклей.
     - Отображает информацию о каждом спектакле (ID, название, цена, дата, свободные места) для администратора.

2. **`add_event(name, price, date, free_slots)`**

   - **Описание**: Эта функция позволяет администратору добавлять новый спектакль в таблицу `events`.
   - **Функционал**:
     - Подключается к базе данных.
     - Вставляет новую запись со всеми необходимыми данными (название, цена, дата, количество свободных мест) в таблицу `events`.
     - Обрабатывает ошибки и выводит сообщение о результате операции.

3. **`delete_event(event_id)`**

   - **Описание**: Эта функция позволяет администратору удалять спектакль из таблицы `events`.
   - **Функционал**:
     - Подключается к базе данных.
     - Проверяет наличие спектакля с указанным ID.
     - Если спектакль существует, удаляет запись из таблицы `events`.
     - Обрабатывает ошибки, например, если спектакль не найден, и выводит соответствующее сообщение.

4. **`get_all_customers()`**

   - **Описание**: Эта функция выводит список всех покупателей, зарегистрированных в системе.
   - **Функционал**:
     - Подключается к базе данных.
     - Выполняет SQL-запрос для выборки всех записей из таблицы `customers`.
     - Отображает информацию о каждом покупателе (ID, имя, возраст, электронная почта, телефон).

5. **`get_customers_by_event(event_id)`**

   - **Описание**: Эта функция позволяет получить список покупателей, зарегистрированных на конкретный спектакль.
   - **Функционал**:
     - Подключается к базе данных.
     - Выполняет SQL-запрос для выборки покупателей, связанных с указанным спектаклем в таблице `orders`.
     - Отображает информацию о каждом покупателе, включая контактные данные.

6. **`get_customers_not_registered(event_id)`**

   - **Описание**: Эта функция возвращает список покупателей, не зарегистрированных на конкретный спектакль.
   - **Функционал**:
     - Подключается к базе данных.
     - Выполняет SQL-запрос для выборки покупателей, которые не связаны с указанным спектаклем.
     - Отображает информацию о каждом покупателе.

7. **`get_sales_ranking()`**

   - **Описание**: Эта функция возвращает ранжированный список спектаклей по количеству проданных билетов.
   - **Функционал**:
     - Подключается к базе данных.
     - Выполняет SQL-запрос для агрегации данных о заказах и подсчета количества билетов, проданных на каждый спектакль.
     - Отображает список спектаклей с указанием количества проданных билетов.

8. **`get_revenue_ranking()`**

   - **Описание**: Эта функция возвращает ранжированный список спектаклей по сумме, полученной от продаж билетов.
   - **Функционал**:
     - Подключается к базе данных.
     - Выполняет SQL-запрос для подсчета общей суммы, полученной от продаж билетов для каждого спектакля.
     - Отображает список спектаклей с указанием общей суммы дохода.


